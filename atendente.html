<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Painel Atendente</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Poppins', sans-serif; background: #f4f7f6; text-align: center; padding: 50px; }
        .painel { background: white; padding: 40px; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); display: inline-block; min-width: 300px; }
        .numero { font-size: 80px; color: #11998e; margin: 20px 0; font-weight: bold; }
        button { padding: 15px 30px; background: #11998e; color: white; border: none; border-radius: 10px; cursor: pointer; font-size: 18px; }
        button:hover { background: #0e867d; }
    </style>
</head>
<body>
    <div class="painel">
        <h1>Senha Atual</h1>
        <div class="numero" id="numExibido">000000</div>
        <p id="infoNome">Aguardando chamada...</p>
        <button id="btnProx">PRÓXIMA SENHA</button>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyD-Jymhub4TY_gsIAfYnHBw6VoRDvHdfmY",
            authDomain: "fila-coordenacao.firebaseapp.com",
            databaseURL: "https://fila-coordenacao-default-rtdb.firebaseio.com",
            projectId: "fila-coordenacao",
            storageBucket: "fila-coordenacao.firebasestorage.app",
            messagingSenderId: "302987735020",
            appId: "1:302987735020:web:af93f41a0210c98fd29ac9"
        };
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        document.getElementById('btnProx').onclick = function() {
            // Busca a senha mais antiga que está aguardando
            database.ref('fila').orderByChild('status').equalTo('aguardando').limitToFirst(1).once('value', snapshot => {
                if (!snapshot.exists()) {
                    alert("Fila vazia!");
                    return;
                }
                snapshot.forEach(child => {
                    const dados = child.val();
                    document.getElementById('numExibido').innerText = dados.senha;
                    document.getElementById('infoNome').innerText = "Chamando: " + dados.nome;
                    
                    // Marca como atendido no banco para não repetir
                    database.ref('fila/' + child.key).update({ status: 'atendido' });
                });
            });
        };
    </script>
</body>
</html>
