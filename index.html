<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>游뽘 Gerador de Senha - Atendimento Aluno</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Poppins', sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; display: flex; align-items: center; justify-content: center; }
        .container { background: white; padding: 2rem; border-radius: 20px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); max-width: 400px; width: 90%; }
        h1 { text-align: center; color: #333; margin-bottom: 2rem; font-weight: 600; }
        label { display: block; margin: 1rem 0 0.5rem; color: #555; font-weight: 500; }
        input, select, textarea { width: 100%; padding: 0.75rem; border: 2px solid #e1e5e9; border-radius: 10px; font-size: 1rem; transition: border-color 0.3s; }
        input:focus, select:focus, textarea:focus { outline: none; border-color: #667eea; }
        textarea { resize: vertical; min-height: 80px; }
        button { width: 100%; padding: 1rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 10px; font-size: 1.1rem; font-weight: 500; cursor: pointer; transition: transform 0.2s; margin-top: 1rem; }
        button:hover { transform: translateY(-2px); }
        button:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }
        #aguardando { text-align: center; display: none; }
        #aguardando h2 { color: #28a745; font-size: 1.5rem; margin-bottom: 1rem; }
        .senha-gerada { background: #d4edda; padding: 1.5rem; border-radius: 10px; font-size: 1.2rem; font-weight: 600; color: #155724; }
    </style>
</head>
<body>
    <div class="container">
        <h1>游뽘 Gerador de Senha</h1>
        
        <div id="formulario">
            <form id="formSenha">
                <label for="nome">Nome Completo *</label>
                <input type="text" id="nome" required>
                
                <label for="matricula">Matr칤cula *</label>
                <input type="text" id="matricula" required>
                
                <label for="curso">Curso *</label>
                <select id="curso" required>
                    <option value="">Selecione o curso</option>
                    <option value="Psicologia">Psicologia</option>
                    <option value="Administra칞칚o">Administra칞칚o</option>
                    <option value="Direito">Direito</option>
                    <option value="Outros">Outros</option>
                </select>
                
                <label for="responsavel">Respons치vel (opcional)</label>
                <input type="text" id="responsavel">
                
                <label for="motivo">Motivo da Solicita칞칚o (opcional)</label>
                <textarea id="motivo" placeholder="Ex: Declara칞칚o de matr칤cula, hist칩rico escolar..."></textarea>
                
                <button type="submit">Confirmar e Gerar Senha</button>
            </form>
        </div>
        
        <div id="aguardando">
            <h2>Sua senha foi gerada!</h2>
            <div id="senha-exibida" class="senha-gerada"></div>
            <p>Aguarde seu nome ser chamado pelo respons치vel.</p>
        </div>
    </div>

    <!-- Firebase SDK v8 -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script>
        // SEU CONFIG FIREBASE AQUI (substitua pelos seus dados)
        const firebaseConfig = {
            apiKey: "sua-api-key",
            authDomain: "seu-projeto.firebaseapp.com",
            databaseURL: "https://seu-projeto-default-rtdb.firebaseio.com/",
            projectId: "seu-projeto",
            storageBucket: "seu-projeto.appspot.com",
            messagingSenderId: "123456789",
            appId: "sua-app-id"
        };
        
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        
        document.getElementById('formSenha').addEventListener('submit', async (e) => {
            e.preventDefault();
            const btn = e.target.querySelector('button');
            btn.disabled = true;
            btn.textContent = 'Gerando senha...';
            
            const dados = {
                nome: document.getElementById('nome').value,
                matricula: document.getElementById('matricula').value,
                curso: document.getElementById('curso').value,
                responsavel: document.getElementById('responsavel').value || '',
                motivo: document.getElementById('motivo').value || '',
                timestamp: Date.now()
            };
            
            // Gera senha sequencial A001, A002...
            const filaSnapshot = await database.ref('filaSenhas').once('value');
            const totalSenhas = filaSnapshot.numChildren();
            const senhaNum = 'A' + (totalSenhas + 1).toString().padStart(3, '0');
            
            const novaSenhaRef = database.ref('filaSenhas').push();
            await novaSenhaRef.set({...dados, senha: senhaNum});
            
            // Marca como pr칩xima
            await database.ref('proximaSenha').set(novaSenhaRef.key);
            
            // Mostra aguardando
            document.getElementById('formulario').style.display = 'none';
            document.getElementById('aguardando').style.display = 'block';
            document.getElementById('senha-exibida').textContent = `Senha ${senhaNum}`;
            
            btn.textContent = 'Senha Gerada!';
        });
    </script>
</body>
</html>
